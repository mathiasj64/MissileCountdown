<!doctype html>
<html>

<head>
    <title>Missile Calculator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
</head>

<body>
    <div class="container">
        <br>
        <div id="counter">
            Fart i knob:<input id="inputSpeedKnots" type="number"> Afstand i nautiske mil:<input id="inputDistanceNauticMile"
                type="number">

            <button onclick="buttonClicked()">Udregn tid</button>

        </div>

        <hr>
        Timer:
        <br>
        <label style="font-size: 30px;" id="result"></label>

        <div id="startstop">
            <button onclick="startCounter()">Start Nedtælling</button>
        </div>
        <br>
        <button onclick="resetCounter()">Nulstil</button>
        <button onclick="clear()">Clear</button>

        <br>
    </div>
</body>

<script>
    var result;

    function buttonClicked() {
        var speedKnots = $("#inputSpeedKnots").val();
        var distanceNauticalMile = $("#inputDistanceNauticMile").val();

        result = calculateTime(speedKnots, distanceNauticalMile);

        console.log(result);

        $("#result").text(formatTime(result) + " sekunder");
    }

    function calculateTime(speedKnots, distanceNauticalMile) {

        var speedMetersPerSecond = speedKnots / 1.943845;
        var distanceMeters = distanceNauticalMile * 1852;

        var timeSeconds = distanceMeters / speedMetersPerSecond;

        return timeSeconds.toFixed(4);
    }

    function formatTime(seconds) {
        return Math.floor(seconds / 60 ) + ":" + seconds % 60;
    }

    var counter;

    function startCounter() {

        if($("#inputSpeedKnots").val() === '' || $("#inputDistanceNauticMile").val() === '') {
            alert("Husk at udfyld alle felter");
            return;
        }

        $("#startstop").empty();
        $("#startstop")
            .append($('<button onclick="stopCounter()">')
                .append("Stop")
            );

        counter = setInterval(timer, 10);

        function timer() {

            result -= 0.01;

            if (result < 0) {
                result = 0;
                clearInterval(counter);
                $("#result").text(formatTime(result) + " sekunder");
                return;
            }
            $("#result").text(formatTime(result) + " sekunder");
        }

    }

    function stopCounter() {
        $("#startstop").empty();
        $("#startstop")
            .append($('<button onclick="startCounter()">')
                .append("Start Nedtælling")
            );
        clearInterval(counter);
    }

    function resetCounter() {
        buttonClicked();
    }

    function clear() {
        $("#result").text('');
    }

</script>

</html>